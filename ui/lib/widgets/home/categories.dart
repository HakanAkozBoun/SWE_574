import 'dart:convert';
import 'dart:typed_data';

import 'package:flutter/material.dart';
import 'package:recipe/models/category.dart';

class CategoriesWidget extends StatefulWidget {
  final Function(int) onCategorySelected;
  const CategoriesWidget({Key? key, required this.onCategorySelected})
      : super(key: key);

  @override
  _CategoriesWidgetState createState() => _CategoriesWidgetState();
}

class _CategoriesWidgetState extends State<CategoriesWidget> {
  late List<Category> categories = [];
  late List<Category> allCategories = [];
  String base64IMG =
      "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";

  @override
  void initState() {
    super.initState();
    loadCategories();
  }

  Future<void> loadCategories() async {
    try {
      final fetchedCategories = await Category.fetchCategories();
      setState(() {
        categories = fetchedCategories;
        allCategories = [
              Category(
                  id: 0, name: "All", image: "", base64: base64IMG, type: "All")
            ] +
            categories;
      });
    } catch (e) {
      print('Error loading categories: $e');
    }
  }

  @override
  Widget build(BuildContext context) {
    return SingleChildScrollView(
      scrollDirection: Axis.horizontal,
      child: Row(
        children: allCategories.map((category) {
          return buildCategory(
            category.id,
            category.base64,
            category.name,
            onTap: () {
              setState(() {
                widget.onCategorySelected(category.id);
              });
            },
          );
        }).toList(),
      ),
    );
  }

  Widget buildCategory(int categoryId, String imagePath, String label,
      {VoidCallback? onTap}) {
    final width = 70.0;
    final height = 70.0;
    var url = imagePath;
    Uint8List decodedImage = base64Decode(url);
    Uint8List decodedImage2 = base64Decode(base64IMG);

    return Padding(
      padding: const EdgeInsets.all(8.0),
      child: GestureDetector(
        onTap: onTap,
        child: Column(
          children: [
            SizedBox(
              width: width,
              height: height,
              child: Padding(
                padding: const EdgeInsets.all(8.0),
                child: categoryId != 0
                    ? Image.memory(decodedImage, fit: BoxFit.cover)
                    : Image.memory(decodedImage2, fit: BoxFit.cover),
              ),
            ),
            const SizedBox(height: 10),
            Text(label),
          ],
        ),
      ),
    );
  }
}
